<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Mon Aug 04 10:52:17 PDT 2014 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>CommConnection (kura 0.2.0-SNAPSHOT API)</title>
<meta name="date" content="2014-08-04">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CommConnection (kura 0.2.0-SNAPSHOT API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CommConnection.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../org/eclipse/kura/comm/CommURI.html" title="class in org.eclipse.kura.comm"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/eclipse/kura/comm/CommConnection.html" target="_top">Frames</a></li>
<li><a href="CommConnection.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.eclipse.kura.comm</div>
<h2 title="Interface CommConnection" class="title">Interface CommConnection</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd>javax.microedition.io.Connection, javax.microedition.io.InputConnection, javax.microedition.io.OutputConnection, javax.microedition.io.StreamConnection</dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">CommConnection</span>
extends javax.microedition.io.StreamConnection</pre>
<div class="block">This is the primary control class for a Serial port.  An instance of
 this class may be operated on by more than one thread.  Settings will be
 those of the last thread to successfully change each particular setting.  
 <p>
 Code written to use a javax.comm.SerialPort object in a shared mode should
 make use of synchronization blocks where exclusive transactions are wanted.
 In most instances, both the OutputStream and the InputStream should be
 synchronized on, normally with the OutputStream being synchronized first.
 <pre>
 Example Code:
                try {
                        String uri = new CommURI.Builder("/dev/tty.PL2303-00001004")
                                                                                .withBaudRate(19200)
                                                                                .withDataBits(8)
                                                                                .withStopBits(1)
                                                                                .withParity(0)
                                                                                .withTimeout(2000)
                                                                                .build().toString();
                        CommConnection connOne = (CommConnection) CommTest.connectionFactory.createConnection(uri, 1, false);
                        assertNotNull(connOne);
                        uri = new CommURI.Builder("/dev/tty.PL2303-00002006")
                                                                                .withBaudRate(19200)
                                                                                .withDataBits(8)
                                                                                .withStopBits(1)
                                                                                .withParity(0)
                                                                                .withTimeout(2000)
                                                                                .build().toString();
                        CommConnection connTwo = (CommConnection) CommTest.connectionFactory.createConnection(uri, 1, false);
                        assertNotNull(connTwo);
                        
                        InputStream isOne = connOne.openInputStream();
                        OutputStream osOne = connOne.openOutputStream();
                        InputStream isTwo = connTwo.openInputStream();
                        OutputStream osTwo = connTwo.openOutputStream();
                        
                        assertNotNull(isOne);
                        assertNotNull(osOne);
                        assertNotNull(isTwo);
                        assertNotNull(osTwo);
                        
                        //write from one to two
                        byte[] array = "this is a message from one to two\n".getBytes();
                        osOne.write(array);
                        StringBuffer sb = new StringBuffer();
                        int c;
                        while((c = isTwo.read()) != 0xa) {
                                //System.out.println("port 2: read byte: 0x" + Integer.toHexString(c) + " -> " + (char)c);
                                sb.append((char)c);
                        }
                        System.out.println("Port 2: Read from serial port two: " + sb.toString());
                        
                        array = "this is a message from two to one\n".getBytes();
                        osTwo.write(array);
                        sb = new StringBuffer();
                        while((c = isOne.read()) != 0xa) {
                                //System.out.println("port 1: read byte: 0x" + Integer.toHexString(c) + " -> " + (char)c);
                                sb.append((char)c);
                        }
                        System.out.println("Port 1: Read from serial port: " + sb.toString());
                        
                        isOne.close();
                        osOne.close();
                        isOne = null;
                        osOne = null;
                        isTwo.close();
                        osTwo.close();
                        isTwo = null;
                        osTwo = null;
                        connOne.close();
                        connOne = null;
                        connTwo.close();
                        connTwo = null;
                } catch (Exception e) {
                        e.printStackTrace();
                }
 </pre>
 
 Note: avoid blocking read (InputStream.read()) if the InputStream can be closed on a different thread,
 in this case, the read will never exit and the thread will be blocked forever.
 
 It is preferable to test InputStream.available before InputStream.read():
 <pre>
                if (isOne.available() != 0) {
                        c = isOne.read();
                } else {
                try {
                        Thread.sleep(100);
                        continue;
                } catch (InterruptedException e) {
                        return;
                }
</pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#close()">close</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#flushSerialBuffer()">flushSerialBuffer</a></strong>()</code>
<div class="block">Reads all bytes that are waiting in the serial port buffer and returns them in
 an array.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/eclipse/kura/comm/CommURI.html" title="class in org.eclipse.kura.comm">CommURI</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#getURI()">getURI</a></strong>()</code>
<div class="block">Returns the URI for this connection.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#sendCommand(byte[], int)">sendCommand</a></strong>(byte[]&nbsp;command,
           int&nbsp;timeout)</code>
<div class="block">Sends and array of bytes to a CommConnection and returns an array of bytes
 that represents the 'response' to the command.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#sendCommand(byte[], int, int)">sendCommand</a></strong>(byte[]&nbsp;command,
           int&nbsp;timeout,
           int&nbsp;demark)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/eclipse/kura/comm/CommConnection.html#sendMessage(byte[])">sendMessage</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Sends and array of bytes to a CommConnection</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_javax.microedition.io.InputConnection">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;javax.microedition.io.InputConnection</h3>
<code>openDataInputStream, openInputStream</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_javax.microedition.io.OutputConnection">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;javax.microedition.io.OutputConnection</h3>
<code>openDataOutputStream, openOutputStream</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getURI()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getURI</h4>
<pre><a href="../../../../org/eclipse/kura/comm/CommURI.html" title="class in org.eclipse.kura.comm">CommURI</a>&nbsp;getURI()</pre>
<div class="block">Returns the URI for this connection.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>this connection URI</dd></dl>
</li>
</ul>
<a name="sendMessage(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendMessage</h4>
<pre>void&nbsp;sendMessage(byte[]&nbsp;message)
                 throws <a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a>,
                        <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Sends and array of bytes to a CommConnection</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the array of bytes to send to the CommConnection</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="sendCommand(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendCommand</h4>
<pre>byte[]&nbsp;sendCommand(byte[]&nbsp;command,
                 int&nbsp;timeout)
                   throws <a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a>,
                          <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Sends and array of bytes to a CommConnection and returns an array of bytes
 that represents the 'response' to the command.  If the timeout is exceeded
 before any bytes are read on the InputStream null is returned.  This is 
 meant to be used in common command/response type situations when communicating
 with serial devices</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>command</code> - the array of bytes to send to the CommConnection</dd><dd><code>timeout</code> - the maximum length of time to wait before returning a null
                                                response in the event no response is ever returned.</dd>
<dt><span class="strong">Returns:</span></dt><dd>an array of bytes representing the response</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="sendCommand(byte[], int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendCommand</h4>
<pre>byte[]&nbsp;sendCommand(byte[]&nbsp;command,
                 int&nbsp;timeout,
                 int&nbsp;demark)
                   throws <a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a>,
                          <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="flushSerialBuffer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushSerialBuffer</h4>
<pre>byte[]&nbsp;flushSerialBuffer()
                         throws <a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a>,
                                <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Reads all bytes that are waiting in the serial port buffer and returns them in
 an array.  This can be used to read unsolicited messages from an attached
 serial device.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the array of bytes buffered on the InputStream if any</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/eclipse/kura/KuraException.html" title="class in org.eclipse.kura">KuraException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre>void&nbsp;close()
           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>close</code>&nbsp;in interface&nbsp;<code>javax.microedition.io.Connection</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CommConnection.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../org/eclipse/kura/comm/CommURI.html" title="class in org.eclipse.kura.comm"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/eclipse/kura/comm/CommConnection.html" target="_top">Frames</a></li>
<li><a href="CommConnection.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2014. All Rights Reserved.</small></p>
</body>
</html>
